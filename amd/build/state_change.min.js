define ("mod_studentquiz/state_change",["jquery","core/ajax","core/notification","core/str"],function(a,b,c,d){var e={SELECTOR:{STATE_SELECT:"#menustatetype",CHANGE_STATE_BUTTON:"div.singlebutton.continue_state_change [type=submit]",STATE_VALUE_INPUT:"input[name=state]",SUBMIT_STATE_BUTTON:"#change_state",CHANGE_STATE_NOTIFICATION:"span.change-question-state",CURRENT_STATE_TEXT:"div.current-state"},init:function init(){var f=a(e.SELECTOR.SUBMIT_STATE_BUTTON),g=f.attr("data-currentstate");a(document).on("change",e.SELECTOR.STATE_SELECT,{},function(){var b=a(e.SELECTOR.STATE_SELECT),c=a(e.SELECTOR.CHANGE_STATE_BUTTON),d=a(e.SELECTOR.STATE_VALUE_INPUT),f=a(e.SELECTOR.SUBMIT_STATE_BUTTON);if(""!==b.val()&&b.val()!==g){d.val(b.val());c.removeAttr("disabled");f.removeAttr("disabled")}else{c.attr("disabled","disabled");f.attr("disabled","disabled")}});a(document).on("click",e.SELECTOR.SUBMIT_STATE_BUTTON,{},function(){var f=a(e.SELECTOR.STATE_SELECT),h=a(e.SELECTOR.SUBMIT_STATE_BUTTON),i=a(e.SELECTOR.CURRENT_STATE_TEXT);h.attr("disabled","disabled");var j=e.addPendingJSPromise("studentquizStateChange");require(["core/loadingicon"],function(b){var c=a(e.SELECTOR.CHANGE_STATE_NOTIFICATION);b.addIconToContainerRemoveOnCompletion(c,j)});var k={courseid:h.attr("data-courseid"),cmid:h.attr("data-cmid"),questionid:h.attr("data-questionid"),state:f.val()},l,m=b.call([{methodname:"mod_studentquiz_set_state",args:k}],!0,!0);m[0].then(function(a){c.alert(a.status,a.message);j.resolve();g=f.val();var b=f.find("option:selected").text();d.get_string("changecurrentstate","studentquiz",b).done(function(a){i.html(a)});window.opener.location.reload()}).fail(l)})},addPendingJSPromise:function addPendingJSPromise(b){M.util.js_pending(b);var d=a.Deferred();d.then(function(){M.util.js_complete(b);return arguments[0]}).catch(c.exception);return d}};return e});
//# sourceMappingURL=state_change.min.js.map
